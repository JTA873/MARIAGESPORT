<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>Sport & Nutrition - Programme S√®che Intensive</title>
    <link rel="stylesheet" href="app-style.css">
</head>
<body>
    <div id="app">
        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Chargement...</p>
        </div>

        <!-- Onboarding -->
        <div id="onboarding" class="screen">
            <div class="onboarding-container">
                <div class="onboarding-step" id="step2">
                    <h2>Profil 1/2 - Jade</h2>
                    <form id="profileJadeForm">
                        <input type="text" id="nameJade" value="Jade" required>
                        <select id="sexJade" required>
                            <option value="male">Homme</option>
                            <option value="female">Femme</option>
                        </select>
                        <input type="number" id="heightJade" placeholder="Taille (cm)" value="175" required>
                        <input type="number" id="weightJade" placeholder="Poids actuel (kg)" value="95" step="0.1" required>
                        <input type="number" id="targetWeightJade" placeholder="Poids cible (kg)" value="82" step="0.1" required>
                        <input type="date" id="deadlineJade" value="2026-08-08" required>
                        <select id="intensityJade" required>
                            <option value="light">L√©ger</option>
                            <option value="moderate">Mod√©r√©</option>
                            <option value="intense" selected>Intense</option>
                            <option value="extreme">Extr√™me</option>
                        </select>
                        <button type="button" class="btn btn-primary" onclick="saveProfile('jade'); nextStep(3)">Suivant</button>
                    </form>
                </div>

                <div class="onboarding-step hidden" id="step3">
                    <h2>Profil 2/2 - √âlodie</h2>
                    <form id="profileElodieForm">
                        <input type="text" id="nameElodie" value="√âlodie" required>
                        <select id="sexElodie" required>
                            <option value="male">Homme</option>
                            <option value="female" selected>Femme</option>
                        </select>
                        <input type="number" id="heightElodie" placeholder="Taille (cm)" value="170" required>
                        <input type="number" id="weightElodie" placeholder="Poids actuel (kg)" value="87" step="0.1" required>
                        <input type="number" id="targetWeightElodie" placeholder="Poids cible (kg)" value="72" step="0.1" required>
                        <input type="date" id="deadlineElodie" value="2026-08-08" required>
                        <label>
                            <input type="checkbox" id="postpartumElodie">
                            Post-partum (adaptations s√©curitaires)
                        </label>
                        <select id="intensityElodie" required>
                            <option value="light">L√©ger</option>
                            <option value="moderate">Mod√©r√©</option>
                            <option value="intense" selected>Intense mais progressif</option>
                        </select>
                        <button type="button" class="btn btn-primary" onclick="saveProfile('elodie'); finishOnboarding()">Terminer</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="mainApp" class="screen hidden">
            <!-- Header avec navigation -->
            <header class="app-header">
                <h1>üí™ <span id="currentProfileName">Jade</span></h1>
                <div class="profile-switch">
                    <button onclick="switchProfile('jade')" id="btnJade" class="active">Jade</button>
                    <button onclick="switchProfile('elodie')" id="btnElodie">√âlodie</button>
                </div>
            </header>

            <!-- Navigation tabs -->
            <nav class="tabs">
                <button class="tab active" onclick="showTab('today')">üè† Aujourd'hui</button>
                <button class="tab" onclick="showTab('planning')">üìÖ Planning</button>
                <button class="tab" onclick="showTab('workouts')">üí™ Exercices</button>
                <button class="tab" onclick="showTab('recipes')">üçΩÔ∏è Recettes</button>
                <button class="tab" onclick="showTab('shopping')">üõí Courses</button>
                <button class="tab" onclick="showTab('progress')">üìä Stats</button>
            </nav>

            <!-- Tab Content -->
            <main class="content">
                <!-- TODAY TAB -->
                <div id="tab-today" class="tab-content">
                    <div class="deadline-banner">
                        <span>üíç Mariage dans <strong id="daysRemaining">217</strong> jours</span>
                    </div>

                    <!-- Day Navigation -->
                    <div class="day-navigation">
                        <button class="btn-nav-day" onclick="navigateDay(-1)">‚óÄ Jour Pr√©c√©dent</button>
                        <div class="current-day-display">
                            <h3 id="currentDayDisplay">Vendredi 03 Janvier 2026</h3>
                            <p id="currentDayInfo">Jour 1 - Semaine 1</p>
                        </div>
                        <button class="btn-nav-day" onclick="navigateDay(1)">Jour Suivant ‚ñ∂</button>
                    </div>

                    <!-- Phase Info Banner -->
                    <div id="phaseInfoBanner" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center;">
                        <!-- Populated by JS -->
                    </div>

                    <section class="card">
                        <h2>‚ö° Entra√Ænement Aujourd'hui</h2>
                        <div id="todayWorkout" class="workout-card">
                            <h3 id="workoutTitle">HIIT Intense - Focus Ventre/Bras</h3>
                            <div class="workout-meta">
                                <span>‚è± <span id="workoutDuration">60</span> min</span>
                                <span>üî• <span id="workoutIntensity">Intense</span></span>
                                <span>~<span id="workoutCalories">650</span> kcal</span>
                            </div>
                            <div class="workout-exercises" id="workoutExercises">
                                <!-- Populated by JS -->
                            </div>
                            <div class="workout-controls">
                                <select id="workoutSelect" class="workout-select" onchange="changeWorkoutFromSelect()">
                                    <option value="hiit">HIIT Full Body (650 kcal)</option>
                                    <option value="strength">Force & R√©sistance (540 kcal)</option>
                                    <option value="cardio">Cardio Intensif (720 kcal)</option>
                                    <option value="flexibility">Souplesse Active (280 kcal)</option>
                                    <option value="yoga">Yoga Flow (350 kcal)</option>
                                    <option value="homestrength">Force Maison (320 kcal)</option>
                                    <option value="homecardio">Cardio Maison (400 kcal)</option>
                                    <option value="pilates">Pilates Core (220 kcal)</option>
                                    <option value="stretching">Stretching Profond (120 kcal)</option>
                                </select>
                                <button class="btn btn-primary btn-large" onclick="startWorkout()">‚ñ∂ COMMENCER</button>
                            </div>
                        </div>
                    </section>

                    <section class="card">
                        <h2>üçΩ Nutrition - Je√ªne 16/8</h2>
                        <div class="nutrition-summary">
                            <div class="fasting-status" id="fastingStatus">
                                <p>Fen√™tre alimentation : <strong>12:00 - 20:00</strong></p>
                                <p id="fastingTimer">Ouverture dans 3h15</p>
                            </div>
                            <div class="macros-today">
                                <p>Objectif : <strong id="targetCalories">2200</strong> kcal</p>
                                <div class="macros-grid">
                                    <span>Prot√©ines: <strong id="targetProtein">190</strong>g</span>
                                    <span>Glucides: <strong id="targetCarbs">185</strong>g</span>
                                    <span>Lipides: <strong id="targetFat">78</strong>g</span>
                                </div>
                            </div>
                            <div class="macros-consumed">
                                <p><strong>üìä Consommation du jour:</strong></p>
                                <div class="macros-grid consumed">
                                    <span>‚úÖ <strong id="consumedCalories">0</strong> kcal</span>
                                    <span>P: <strong id="consumedProtein">0</strong>g</span>
                                    <span>C: <strong id="consumedCarbs">0</strong>g</span>
                                    <span>L: <strong id="consumedFat">0</strong>g</span>
                                </div>
                            </div>
                            <div id="mealsToday" class="meals-list">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                    </section>

                    <section class="card">
                        <h2>üìä Cette Semaine</h2>
                        <div class="weekly-stats">
                            <div class="stat-item">
                                <span class="stat-label">S√©ances</span>
                                <span class="stat-value" id="weekWorkouts">2/4</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Calories br√ªl√©es</span>
                                <span class="stat-value" id="weekCalories">1250</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Poids</span>
                                <span class="stat-value" id="currentWeight">94.2 kg</span>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- PLANNING TAB -->
                <div id="tab-planning" class="tab-content hidden">
                    <h2>üìÖ Planning Semaine <span id="weekNumber">2</span></h2>
                    <div class="planning-controls" style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
                        <select id="planningPhaseFilter" onchange="loadWeeklyPlan()">
                            <option value="current">Phase actuelle</option>
                            <option value="1">Phase 1 - Agressive</option>
                            <option value="2">Phase 2 - Normale</option>
                        </select>
                        <div class="week-selector">
                            <button onclick="changeWeek(-1)">‚óÄ Pr√©c√©dent</button>
                            <span>Semaine <span id="weekNumberDisplay">2</span> / <span id="totalWeeksInPhase">4</span></span>
                            <button onclick="changeWeek(1)">Suivant ‚ñ∂</button>
                        </div>
                    </div>
                    <div id="weeklyPlan" class="weekly-plan">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- WORKOUTS LIBRARY TAB -->
                <div id="tab-workouts" class="tab-content hidden">
                    <h2>üí™ Biblioth√®que d'Exercices</h2>
                    <div class="filter-bar">
                        <select id="workoutFilter" onchange="filterWorkouts()">
                            <option value="all">Tous les types</option>
                            <option value="hiit">HIIT</option>
                            <option value="strength">Force</option>
                            <option value="cardio">Cardio</option>
                        </select>
                        <input type="text" id="workoutSearch" placeholder="üîç Rechercher un exercice..." oninput="filterWorkouts()">
                    </div>
                    <div id="workoutsList" class="workouts-grid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- RECIPES LIBRARY TAB -->
                <div id="tab-recipes" class="tab-content hidden">
                    <h2>üçΩÔ∏è Biblioth√®que de Recettes</h2>
                    <div class="filter-bar">
                        <select id="recipePhaseFilter" onchange="filterRecipes()">
                            <option value="all">Toutes les phases</option>
                            <option value="1">Phase 1 - Agressive</option>
                            <option value="2">Phase 2 - Normale</option>
                        </select>
                        <select id="recipeWeekFilter" onchange="filterRecipes()">
                            <option value="current">Semaine en cours</option>
                            <option value="all">Toutes les recettes</option>
                        </select>
                        <select id="recipeFilter" onchange="filterRecipes()">
                            <option value="all">Tous les repas</option>
                            <option value="breakfast">Petit-d√©jeuner</option>
                            <option value="lunch">D√©jeuner</option>
                            <option value="snack">Collation</option>
                            <option value="dinner">D√Æner</option>
                        </select>
                        <input type="text" id="recipeSearch" placeholder="üîç Rechercher une recette..." oninput="filterRecipes()">
                        <button class="btn btn-primary" onclick="showAddMealDialog()">+ Ajouter aujourd'hui</button>
                    </div>
                    <div id="recipesList" class="recipes-grid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- SHOPPING TAB -->
                <div id="tab-shopping" class="tab-content hidden">
                    <h2>üõí Liste de Courses</h2>
                    <div class="shopping-controls" style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
                        <div>
                            <label for="shoppingWeeksSelect" style="display: block; font-size: 0.9rem; font-weight: 600; color: var(--primary); margin-bottom: 5px;">üìÖ Courses pour :</label>
                            <select id="shoppingWeeksSelect" style="padding: 8px 12px; border: 2px solid var(--light-gray); border-radius: 8px; font-size: 0.95rem; cursor: pointer;">
                                <option value="1">1 semaine</option>
                                <option value="2">2 semaines</option>
                                <option value="3">3 semaines</option>
                                <option value="4">4 semaines</option>
                                <option value="6">6 semaines</option>
                                <option value="8">8 semaines</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="generateShoppingList()">üîÑ G√©n√©rer la liste</button>
                    </div>
                    <div id="shoppingList" class="shopping-list">
                        <!-- Populated by JS -->
                    </div>
                    <button class="btn btn-secondary" onclick="exportShoppingPDF()">üìÑ Exporter PDF</button>
                </div>

                <!-- PROGRESS TAB -->
                <div id="tab-progress" class="tab-content hidden">
                    <h2>üìä Progression Couple</h2>
                    <div class="comparison-grid">
                        <div class="profile-progress">
                            <h3>üë® Jade</h3>
                            <div class="progress-stats">
                                <p>S√©ances : <strong id="jadeWorkouts">2/4</strong></p>
                                <p>Calories : <strong id="jadeCalories">1250</strong> kcal</p>
                                <p>Poids : <strong id="jadeWeight">94.2</strong> kg (<span id="jadeChange">-0.8</span> kg)</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="jadeProgress" style="width: 50%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="profile-progress">
                            <h3>üë© √âlodie</h3>
                            <div class="progress-stats">
                                <p>S√©ances : <strong id="elodieWorkouts">3/4</strong></p>
                                <p>Calories : <strong id="elodieCalories">890</strong> kcal</p>
                                <p>Poids : <strong id="elodieWeight">86.1</strong> kg (<span id="elodieChange">-0.9</span> kg)</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="elodieProgress" style="width: 75%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>üèÜ Objectif Commun</h3>
                        <p>Mariage 08/08/2026 - J-217</p>
                        <p>Perte combin√©e : <strong>1.7 kg</strong> / 26 kg</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 6.5%"></div>
                        </div>
                        <p class="progress-percent">6.5%</p>
                    </div>

                    <div class="card">
                        <h3>‚öñÔ∏è Logger Poids</h3>
                        <div class="weight-logger">
                            <input type="number" id="newWeight" step="0.1" placeholder="Poids (kg)">
                            <input type="date" id="weightDate" value="">
                            <button class="btn btn-primary" onclick="logWeight()">Enregistrer</button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Workout Session Screen -->
        <!-- Exercise Detail Modal -->
        <div id="exerciseModal" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" onclick="closeExerciseModal()">√ó</button>
                <h2 id="modalExerciseName"></h2>
                <div id="modalExerciseContent"></div>
                <button class="btn btn-primary" onclick="startWorkoutFromModal()">Commencer cet entra√Ænement</button>
            </div>
        </div>

        <!-- Recipe Detail Modal -->
        <div id="recipeModal" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" onclick="closeRecipeModal()">√ó</button>
                <h2 id="modalRecipeName"></h2>
                <div id="modalRecipeContent"></div>
                <button class="btn btn-primary" onclick="addRecipeToToday()">Ajouter √† aujourd'hui</button>
            </div>
        </div>

        <!-- Add Meal Dialog -->
        <div id="addMealDialog" class="modal hidden">
            <div class="modal-content">
                <button class="modal-close" onclick="closeAddMealDialog()">√ó</button>
                <h2>Ajouter un repas</h2>
                <p>S√©lectionnez un repas dans la biblioth√®que de recettes</p>
                <button class="btn btn-secondary" onclick="closeAddMealDialog(); showTab('recipes')">Voir les recettes</button>
            </div>
        </div>

        <!-- Day Detail Modal -->
        <div id="dayDetailModal" class="modal hidden">
            <div class="modal-content" style="max-width: 800px;">
                <button class="modal-close" onclick="closeDayDetailModal()">√ó</button>
                <h2 id="dayDetailTitle"></h2>
                <div id="dayDetailContent"></div>
            </div>
        </div>

        <!-- Workout Session Modal -->
        <div id="workoutSession" class="modal hidden">
            <div class="modal-content" style="max-width: 600px;">
                <div class="session-header">
                    <button class="modal-close" onclick="exitWorkout()">√ó</button>
                    <h2 id="sessionTitle">HIIT Intense</h2>
                </div>
                <div class="session-content">
                    <div class="timer-display">
                        <div class="timer-circle">
                            <span id="timerDisplay">00:00</span>
                        </div>
                        <p id="currentExercise">Rameur 500m</p>
                        <div id="exerciseDetail">
                            <p>Effort 8/10</p>
                        </div>
                    </div>
                    <div class="session-controls">
                        <button class="btn btn-primary btn-large" id="timerBtn" onclick="toggleTimer()">‚ñ∂ D√âMARRER</button>
                        <button class="btn btn-secondary" onclick="skipExercise()">‚è≠ Suivant</button>
                    </div>
                    <div class="session-stats">
                        <span>Exercice <span id="exerciseIndex">1</span>/<span id="totalExercises">8</span></span>
                        <span>Calories: ~<span id="sessionCalories">0</span> kcal</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app-script.js"></script>
</body>
</html>
